#!/bin/bash

Nmap Scripting Engine (NSE) Combined Script
Usage: ./nmap-nse-combined.sh <target>
Check if Nmap is installed
if ! command -v nmap &> /dev/null
then
echo "Nmap is not installed, please install it and try again."
exit
fi

Check if the required number of arguments are passed
if [ "$#" -ne 1 ]; then
echo "Usage: $0 <target>"
exit 1
fi

target=$1

Firewalk
nmap -sS --script=firewalk $target

FTP Anon
nmap -sV --script=ftp-anon $target

FTP Bounce
nmap -sV --script=ftp-bounce $target

HTTP-Auth
nmap --script http-auth [--script-args http-auth.path=/login] -p80 $target

HTTP-cookie-flags
nmap -p 443 --script http-cookie-flags $target

http-csrf
nmap -p80 --script http-csrf.nse $target

http-date
nmap -sV --script=http-date $target

http-server header
nmap -sV $target

http-sql-injection
nmap -sV --script=http-sql-injection $target

http-waf-fingerprint
nmap --script=http-waf-fingerprint $target

http-waf-detect
nmap -p80 --script http-waf-detect $target

http-title
nmap -sV -sC $target

http-security-headers
nmap -p80 --script=http-security-headers $target

http-ntlm-info
nmap -p 80 --script http-ntlm-info --script-args http-ntlm-info.root=/root/ $target

http-fileupload-exploiter
nmap -p80 --script http-fileupload-exploiter.nse $target

echo "Nmap NSE script scan completed for $target. Check the output above for results."